<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQL Sampling Calculator (Simplified)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <h1>AQL Sampling Calculator (Simplified)</h1>
        <p>For General Inspection Level II (Normal Inspection)</p>
        
        <!-- Help Button and Modal -->
        <button type="button" id="helpButton" class="help-button" aria-label="Open help information">?</button>
        <div id="helpModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>AQL Calculator Help</h3>
                <p><strong>Lot Size</strong>: Total number of items in the batch, calculated as Number of Boxes × Pieces per Box.</p>
                <p><strong>AQL (Acceptable Quality Level)</strong>: The maximum defect rate considered acceptable. Lower AQLs (e.g., 1.0%) indicate stricter quality standards.</p>
                <p><strong>Sample Size</strong>: Number of items to inspect, determined by the AQL table and lot size.</p>
                <p><strong>Acceptance Number (Ac)</strong>: Maximum number of defects allowed in the sample to accept the lot.</p>
                <p><strong>Rejection Number (Re)</strong>: Number of defects that triggers lot rejection.</p>
                <button type="button" id="closeHelp" class="modal-close">Close</button>
            </div>
        </div>

        <div id="error-message" class="error-message" style="display: none;"></div>

        <form id="aqlForm">

            <div class="form-section batch-info">
                <h2>Batch Identification</h2>
                <div class="form-grid">
                    <div>
                        <label for="qcInspector">QC Inspector:</label>
                        <input type="text" id="qcInspector" name="qcInspector">
                    </div>
                    <div>
                        <label for="operatorName">Operator Name:</label>
                        <input type="text" id="operatorName" name="operatorName">
                    </div>
                    <div>
                        <label for="machineNumber">Machine No:</label>
                        <input type="text" id="machineNumber" name="machineNumber">
                    </div>
                    <div>
                        <label for="partName">Part Name:</label>
                        <input type="text" id="partName" name="partName">
                    </div>
                    <div>
                        <label for="partId">Part ID:</label>
                        <input type="text" id="partId" name="partId">
                    </div>
                </div>
            </div>

            <div class="form-section lot-details">
                <h2>Lot & Sampling Details</h2>
                <div class="form-grid">
                    <div>
                        <label for="numBoxes" title="Total number of boxes in the batch">Number of Boxes:</label>
                        <input type="number" id="numBoxes" name="numBoxes" min="1" required>
                    </div>
                    <div>
                        <label for="pcsPerBox" title="Number of pieces in each box">Pieces per Box:</label>
                        <input type="number" id="pcsPerBox" name="pcsPerBox" min="1" required>
                    </div>
                    <div>
                        <label for="lotSize" title="Total pieces in the batch (Number of Boxes × Pieces per Box)">Total Lot Size:</label>
                        <input type="number" id="lotSize" name="lotSize" readonly required>
                    </div>
                    <div>
                        <label for="aql" title="Maximum acceptable defect rate (lower AQL = stricter quality)">Acceptable Quality Level:</label>
                        <select id="aql" name="aql" required>
                            <option value="">-- Select Quality --</option>
                            <option value="1.0">High Quality (AQL 1.0%)</option>
                            <option value="2.5">Medium Quality (AQL 2.5%)</option>
                            <option value="4.0">Low Quality (AQL 4.0%)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button type="button" id="calculateButton">Calculate Sampling Plan</button>
                <button type="button" id="resetButton">Reset</button>
                <button type="button" id="saveDraftButton">Save Draft</button>
                <button type="button" id="loadInspectionsButton">Load Inspections</button>
            </div>

        </form>

        <!-- Load Inspections Modal -->
        <div id="loadInspectionsModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Saved Inspections</h3>
                <div id="inspectionsList"></div>
                <button type="button" id="closeLoadModal" class="modal-close">Close</button>
            </div>
        </div>

        <div id="results" class="results-section">
            <p class="initial-message">Please enter batch details, select quality level, and click calculate.</p>
        </div>

        <div id="defectsInputArea" class="form-section" style="display: none;">
            <label for="defectsFound">Number of Defects Found in Sample:</label>
            <input type="number" id="defectsFound" name="defectsFound" min="0" required>
            <button type="button" id="submitDefectsButton">Submit Defects & Get Verdict</button>
        </div>

        <div id="verdictMessage" class="results-section" style="display: none;"></div>

        <div id="defectChecklist" class="form-section checklist-section" style="display: none;">
            <h4>Observed Defect Types (Plastic Parts - Optional)</h4>
            <div class="checklist-container">
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Scratches"> Plastic - Scratches
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Short Mould"> Plastic - Short Mould
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Painting Peel Off"> Plastic - Painting Peel Off
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Silkscreen Peel Off / Poor"> Plastic - Silkscreen Peel Off / Poor
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Weld/Joint Line Visible"> Plastic - Weld/Joint Line Visible
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Stressed Mark"> Plastic - Stressed Mark
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Bubble"> Plastic - Bubble
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Warped / Deformed"> Plastic - Warped / Deformed
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Excessive Flashes"> Plastic - Excessive Flashes
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Dirty / Stain"> Plastic - Dirty / Stain
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Oil Stain"> Plastic - Oil Stain
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Silverstreak"> Plastic - Silverstreak
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Brittle"> Plastic - Brittle
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Sink Mark"> Plastic - Sink Mark
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Flow Mark (Cosmetic)"> Plastic - Flow Mark (Cosmetic)
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Ejector Mark Visible"> Plastic - Ejector Mark Visible
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Cracked Part"> Plastic - Cracked Part
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Broken Part"> Plastic - Broken Part
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Un-shining / Poor Gloss"> Plastic - Un-shining / Poor Gloss
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Plastic - Spots / Black Dot"> Plastic - Spots / Black Dot
                </label>
                <label>
                    <input type="checkbox" name="defect_type" value="Other"> Other (Specify if needed in report notes)
                </label>
            </div>
        </div>

        <div class="button-group">
            <button type="button" id="generateReportButton" style="display: none;">Generate Full Report</button>
            <button type="button" id="savePdfButton" style="display: none;">Save as PDF</button>
            <button type="button" id="printButton" style="display: none;">Print Report</button>
        </div>

        <div id="finalReportArea" class="results-section report-area" style="display: none;">
            <h2>Final Inspection Report</h2>
            <div id="reportContent"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>