<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#6a0dad">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
  <title>InspectWise Go‚Ñ¢</title>
</head>
<body>

  <div class="app-wrapper">
    <header class="header">
      <h1>InspectWise Go</h1>
      <p>Smart Sampling Tool.</p>
    </header>

    <!-- Form Section Starts -->
    <form id="aqlForm">
      <div class="form-section batch-info">
        <h2>Batch Identification</h2>
        <div class="form-grid">
          <div>
            <label for="qcInspector">QC Inspector:</label>
            <select id="qcInspector" required>
              <option value="">-- Select QC Inspector --</option>
              <option value="Khirul Anuar">KHIRUL ANUAR</option>
              <option value="Hemapria">HEMAPRIA</option>
              <option value="Popo">POPO</option>
              <option value="Dharisini">DHARISINI</option>
            </select>
          </div>
          <div>
            <label for="machineNumber">Machine No:</label>
            <select id="machineNumber">
              <option value="">-- Select Machine No --</option>
              <option value="M1">M1</option>
              <option value="M2">M2</option>
              <option value="M3">M3</option>
            </select>
          </div>
          <div>
            <label for="partName">Part Name:</label>
            <select id="partName" required></select>
          </div>
          <div>
            <label for="partId">Part ID:</label>
            <input type="text" id="partId" readonly>
          </div>
          <div>
            <label for="poNumber">PO Number:</label>
            <input type="text" id="poNumber" required>
          </div>
          <div>
            <label for="productionDate">Production Date:</label>
            <input type="date" id="productionDate" required>
          </div>
        </div>
      </div>

      <div class="form-section lot-details" style="display:none;">
        <h2>Lot & AQL Details</h2>
        <div class="form-grid">
          <div>
            <label for="numBoxes">Number of Boxes:</label>
            <input type="number" id="numBoxes" min="1">
          </div>
          <div>
            <label for="pcsPerBox">Pieces per Box:</label>
            <input type="number" id="pcsPerBox" min="1">
          </div>
          <div>
            <label for="lotSize">Calculated Lot Size:</label>
            <input type="text" id="lotSize" readonly>
          </div>
          <div>
            <label for="aql">AQL Level:</label>
            <select id="aql">
              <option value="">-- Select AQL --</option>
              <option value="1.0">High (1.0%)</option>
              <option value="2.5">Medium (2.5%)</option>
              <option value="4.0">Low (4.0%)</option>
            </select>
          </div>
        </div>
      </div>

      <div class="button-group" style="display:none;">
        <button type="button" id="calculateButton">üìä Calculate Sampling Plan</button>
        <button type="button" id="resetButton">üîÑ Reset</button>
      </div>

      <div id="results" class="results-section" style="display:none;"></div>

      <div id="defectsInputArea" class="form-section" style="display:none;">
        <h3>Defect Count</h3>
        <label for="defectsFound">Total Defects Found:</label>
        <input type="number" id="defectsFound" min="0">
        <button type="button" id="submitDefectsButton">‚úÖ Submit</button>
      </div>

      <div id="verdictMessage" class="verdict-message" style="display:none;"></div>

      <div id="defectChecklist" class="form-section" style="display:none;">
        <h3>Observed Defect Types</h3>
        <label><input type="checkbox" name="defect_type" value="Misalignment"> Misalignment</label>
        <label><input type="checkbox" name="defect_type" value="Overflow"> Overflow</label>
        <label><input type="checkbox" name="defect_type" value="Fade Print"> Fade Print</label>
        <label><input type="checkbox" name="defect_type" value="Smudge"> Smudge</label>
      </div>

      <div id="photoCaptureArea" class="form-section photo-section" style="display:none;">
        <h4>Photo Documentation (Optional)</h4>
        <p>Add up to 5 photos to document defects.</p>
        <div class="photo-options">
          <label for="uploadMultiplePhotos" class="upload-button">Upload Multiple Photos
            <input type="file" id="uploadMultiplePhotos" accept="image/*" multiple>
          </label>
        </div>
        <div id="photoPreview" class="photo-preview">
          <p>No photos added yet.</p>
        </div>
        <p id="photoCount">Photos: 0/5</p>
      </div>

      <!-- Annotation Modal -->
      <div id="annotationModal" class="modal" style="display:none;">
        <div class="modal-content">
          <span class="close-modal">√ó</span>
          <h3>Annotate Photo</h3>
          <div class="annotation-tools">
            <button id="drawCircleButton" class="tool-button">Draw Circle</button>
            <button id="drawTextButton" class="tool-button">Add Text</button>
            <button id="drawFreehandButton" class="tool-button">Freehand Draw</button>
            <button id="undoButton" class="tool-button">Undo</button>
            <button id="saveAnnotationButton" class="tool-button save-button">Save</button>
          </div>
          <canvas id="annotationCanvas" class="annotation-canvas"></canvas>
        </div>
      </div>

      <div class="button-group">
        <button type="button" id="generateReportButton" style="display:none;">üìù Generate Report</button>
      </div>

      <div id="finalReportArea" class="results-section report-area" style="display:none;">
        <h2>Final Inspection Report</h2>
        <div id="reportContent"></div>
        <div class="button-group">
          <button type="button" id="savePdfButton" style="display:none;">üíæ Save PDF</button>
          <button type="button" id="printButton" style="display:none;">üñ®Ô∏è Print</button>
        </div>
      </div>
    </form>

    <!-- Error Message -->
    <div id="error-message" class="error-message" style="display:none;"></div>

    <!-- Footer -->
    <footer class="footer">
      <p>Copyright ¬© 2025. InspectWise Go‚Ñ¢ is developed and maintained by Khirul Anuar for KPI Electrical Manufacturing Sdn. Bhd.</p>
    </footer>
  </div>

  <!-- Load JavaScript -->
  <script src="js/partsList.js"></script>
  <script type="module" src="js/main.js"></script>

</body>
</html>
