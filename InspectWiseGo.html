<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2575fc">
  <meta name="description" content="InspectWise Go: Smart Sampling Tool for Quality Control">
  <title>InspectWise Go - KPI Electrical</title>
  <link rel="icon" href="/QualityControl/icon-192.png">
  <link rel="manifest" href="/QualityControl/manifest.json">
  <link rel="stylesheet" href="/QualityControl/style.css">
</head>
<body>
  <header>
    <h1>InspectWise Go</h1>
    <p>Smart Sampling Tool for Quality Control Inspections</p>
  </header>

  <main>
    <form id="aqlForm">
      <section class="batch-info">
        <h2>Batch Identification</h2>
        <div class="form-group">
          <label for="qcInspector">QC Inspector Name:</label>
          <input type="text" id="qcInspector" required aria-required="true">
        </div>
        <div class="form-group">
          <label for="machineNumber">Machine No:</label>
          <input type="text" id="machineNumber" required aria-required="true">
        </div>
        <div class="form-group">
          <label for="partName">Part Name:</label>
          <select id="partName" required aria-required="true"></select>
        </div>
        <div class="form-group">
          <label for="partId">Part ID:</label>
          <input type="text" id="partId" readonly>
        </div>
        <div class="form-group">
          <label for="poNumber">PO Number:</label>
          <input type="text" id="poNumber" required aria-required="true">
        </div>
        <div class="form-group">
          <label for="productionDate">Production Date:</label>
          <input type="date" id="productionDate" required aria-required="true">
        </div>
      </section>

      <section class="lot-details">
        <h2>Lot Details</h2>
        <div class="form-group">
          <label for="numBoxes">Number of Boxes:</label>
          <input type="number" id="numBoxes" min="1" aria-describedby="numBoxesHelp">
          <small id="numBoxesHelp">Enter the total number of boxes in the lot.</small>
        </div>
        <div class="form-group">
          <label for="pcsPerBox">Pieces per Box:</label>
          <input type="number" id="pcsPerBox" min="1" aria-describedby="pcsPerBoxHelp">
          <small id="pcsPerBoxHelp">Enter the number of pieces per box.</small>
        </div>
        <div class="form-group">
          <label for="lotSize">Total Lot Size:</label>
          <input type="number" id="lotSize" readonly aria-describedby="lotSizeHelp">
          <small id="lotSizeHelp">Automatically calculated as Number of Boxes Ã— Pieces per Box.</small>
        </div>
        <div class="form-group">
          <label for="aql">Acceptable Quality Level (AQL):</label>
          <select id="aql" required aria-required="true">
            <option value="">-- Select AQL --</option>
            <option value="1.0">High Quality (AQL 1.0%)</option>
            <option value="2.5">Medium Quality (AQL 2.5%)</option>
            <option value="4.0">Low Quality (AQL 4.0%)</option>
          </select>
        </div>
      </section>

      <div class="button-group">
        <button type="button" id="calculateButton" disabled>Calculate Sampling Plan</button>
        <button type="button" id="resetButton">Reset</button>
      </div>
    </form>

    <div id="error-message" class="error-message hidden" role="alert"></div>

    <section id="results">
      <p class="initial-message">Please enter batch details, select quality level, and click calculate.</p>
    </section>

    <section id="defectsInputArea" style="display: none;">
      <h2>Enter Inspection Results</h2>
      <div class="form-group">
        <label for="defectsFound">Number of Defects Found:</label>
        <input type="number" id="defectsFound" min="0" value="0" aria-describedby="defectsFoundHelp">
        <small id="defectsFoundHelp">Enter the total number of defects found during inspection.</small>
      </div>
      <button type="button" id="submitDefectsButton" disabled>Submit Defects</button>
    </section>

    <section id="photoCaptureArea" style="display: none;">
      <h2>Photo Documentation</h2>
      <p>Add photos of defects (max 5, 5MB each).</p>
      <div class="form-group">
        <label for="uploadMultiplePhotos">Upload Photos:</label>
        <input type="file" id="uploadMultiplePhotos" accept="image/*" multiple>
      </div>
      <p id="photoCount">Photos: 0/5</p>
      <div id="photoPreview"></div>
    </section>

    <section id="defectChecklist" style="display: none;">
      <h2>Defect Type Checklist</h2>
      <div class="checkbox-group">
        <label><input type="checkbox" name="defect_type" value="Scratch"> Scratch</label>
        <label><input type="checkbox" name="defect_type" value="Dent"> Dent</label>
        <label><input type="checkbox" name="defect_type" value="Crack"> Crack</label>
        <label><input type="checkbox" name="defect_type" value="Misalignment"> Misalignment</label>
        <label><input type="checkbox" name="defect_type" value="Color Variance"> Color Variance</label>
        <label><input type="checkbox" name="defect_type" value="Other"> Other</label>
      </div>
    </section>

    <section id="verdictMessage" style="display: none;"></section>

    <button id="generateReportButton" style="display: none;">Generate Report</button>

    <section id="finalReportArea" style="display: none;">
      <h2>Final Report</h2>
      <div id="reportContent"></div>
      <div class="report-buttons">
        <button id="savePdfButton" style="display: none;">Save as PDF</button>
        <button id="printButton" style="display: none;">Print Report</button>
      </div>
    </section>
  </main>

  <div id="annotationModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>Annotate Photo</h2>
      <div class="annotation-tools">
        <button id="drawCircleButton">Circle</button>
        <button id="drawTextButton">Text</button>
        <button id="drawFreehandButton">Freehand</button>
        <button id="undoButton">Undo</button>
        <button id="saveAnnotationButton">Save</button>
      </div>
      <canvas id="annotationCanvas"></canvas>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 KPI Electrical Manufacturing Sdn. Bhd. All rights reserved.</p>
  </footer>

  <script defer src="/QualityControl/partsList.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <script defer src="/QualityControl/script.js"></script>
</body>
</html>